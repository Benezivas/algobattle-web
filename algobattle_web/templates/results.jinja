{% extends "base.jinja" %}
{% block content %}

<script src="/static/scripts/results.js" type="module"></script>
<script>
  const results = {{results | tojson}}
  const teams = {{teams | tojson}}
  const programs = {{programs | tojson}}
  const problems = {{problems | tojson}}
</script>


<script type="text/x-template" id="result">
  <div class="accordion-item">
    <h2 class="accordion-header" :id="'heading' + result.id">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" :data-bs-target="'#collapse' + result.id" aria-expanded="false" :aria-controls="'collapse' + result.name">
        ${fmt_date(result.time)}
      </button>
    </h2>
    <div :id="'collapse' + result.id" class="accordion-collapse collapse" :aria-labelledby="'heading' + result.id" data-bs-parent="#results">
      <table class="table">
        <tbody>
          <tr>
            <td>Status</td>
            <td>${result.status}</td>
          </tr>
          <tr>
            <td>Problem</td>
            <td>${store.problems[result.problem].name}</td>
          </tr>
          <tr>
            <td>Logs</td>
            <td>
              <a role="button" v-if="result.logs" class="btn btn-primary btn-sm" :href="'/api/result/logs/'+result.id" data-bs-toggle="tooltip" title="Download logs">${result.logs.name} <i class="bi bi-download ms-1"></i></a>
            </td>
          </tr>
          <tr>
            <td>Participants</td>
            <td>
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Team</th>
                    <th scope="col">Generator</th>
                    <th scope="col">Solver</th>
                    <th scope="col">Points</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="participant in result.participants">
                    <td>${store.teams[participant.team].name}</td>
                    <td>${store.programs[participant.generator].name}</td>
                    <td>${store.programs[participant.solver].name}</td>
                    <td>${participant.points}</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</script>

<div id="app">
  <h3>Match Results</h3>
  <div class="accordion" id="results">
    <Result v-for="(result, id) in store.results" :key="id" :result="result"></Result>
</div>

{% endblock %}
